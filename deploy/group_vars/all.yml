#########
# PROJECT
#########

# Tell Ansible to use python3
ansible_python_interpreter: /usr/bin/python3

# Certain tasks may operate in a less secure (but more convenient) manner, eg.
# enabling passwordless sudo or generating self-signed ssl certs, when testing
# locally, in Vagrant. But not in production!
env: production

# This var is referenced by a few other vars, eg. git_repo, hostname, site_fqdn.
project_name: yalepaprika

# This is what you'll see at the bash prompt if/when you ssh into your server.
hostname: "{{project_name}}"

# This is the fully qualified domain name of your production server. Because
# caddy checks this value against the URL being requested, it must be the same
# as the server's DNS name. This value is overridden for Vagrant and staging
# servers.
site_fqdn: "yalepaprika.com"

##############
# PROVISIONING
##############

# Keys to be added to apt.
apt_keys:
  - "https://packagecloud.io/github/git-lfs/gpgkey"
  - "https://deb.nodesource.com/gpgkey/nodesource.gpg.key"

# Ppas to be added to apt. Useful ppas (replace trusty with your Ubuntu
# version codename, if necessary):
# Node.js 14.x (LTS): deb https://deb.nodesource.com/node_14.x bionic main
# Caddy latest:       deb [trusted=yes] https://apt.fury.io/caddy/ /
#   Gemfury does not support GPG keys yet, https://gemfury.com/help/apt-repository/
# Git latest:         ppa:git-core/ppa
# PHP latest:         ppa:ondrej/php
apt_ppas:
  - "deb https://deb.nodesource.com/node_14.x bionic main"
  - "deb [trusted=yes] https://apt.fury.io/caddy/ /"
  - "ppa:git-core/ppa"
  - "deb https://packagecloud.io/github/git-lfs/{{ansible_distribution|lower}}/ {{ansible_distribution_release}} main"
  - "deb-src https://packagecloud.io/github/git-lfs/{{ansible_distribution|lower}}/ {{ansible_distribution_release}} main"
  - "ppa:ondrej/php"

# Any apt packages to install. Apt package versions may be specified like
# - git=2.1.0
# build-essential is required to compile native addons from npm modules
apt_packages:
  - unattended-upgrades
  - build-essential
  - caddy
  - git
  - git-lfs
  - nodejs
  - php7.4
  - php7.4-fpm
  - php7.4-mbstring
  - php7.4-curl
  - php7.4-gd
  - php-xdebug

php_version: 7.4

# Any global npm modules to install. App-specific modules are installed in deploy tasks
npm_global_modules: []
# npm_global_modules:
#   - pm2

############
# WEB SERVER
############

# If ssl is enabled, email address to receive notifications from letsencrypt.
letsencrypt_email: s3th.thompson@gmail.com

#######
# USERS
#######

# Specified users will be added to the remote server, along with all specified
# public keys. Removing a user from this list does NOT remove them from the
# remote server! You need to set their state to "absent", remove all the other
# properties for that user, and re-run the "configure" playbook. Also, the
# shadow password (that user's sudo password) should be a hash, and NOT plain
# text!
#
# Generate a shadow password hash using the following command:
# openssl passwd -1 -salt $(openssl rand -base64 6) yourpassword
#

users:
  - name: seththompson
    state: present
    real_name: Seth Thompson
    public_keys:
      - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDQeS0rX9gCiEBd2Yy4PzSHATgpfDCsl0Av535tqW8JK47Ydbq9BgNMCmQjW6XMju4KQyDdrw5SlOjksglUHBP8IvHQjAKkO4p4bUz8sVx3N6BrFGRPLc7YSOpbAJF5omMKTqVzprL5ekezyTxfDIL3HzZi0Cs6jOt/6M6kt8ESqN56jocyv6WGmFC4ZNm8DAMVSlXjkBVhd+SeentSDKOwJuIi+ugB8x8bDuouIqcumx5mm9ydImT0bi9pORoUH4C+sxBDYVJ13Ejk86bKa7YQdHhsw+9qinNlVjNmMB3nj/K3g5ajmX6CiTwqkftsy30vHlsuaPwsJMPLY5aYMwDf s3th.thompson@gmail.com

########
# DEPLOY
########

# Parent directory for cloned repository directories. The clone_path and
# site_path should be children of this directory.
base_path: /var/www

# Temporary location where the Git repo will be cloned and the build scripts
# will be run before going live.
clone_path: "{{base_path}}/temp"

# Where the production site symlink will exist.
site_path: "{{base_path}}/current"

# If defined, only this many of the most recent clone directories (including the
# current specified commit) will be retained. Anything older will be removed,
# once the current clone has been made live.
keep_n_most_recent: 2

# If this variable is defined, a file containing build information, including
# the timestamp, commit, sha, and a few other useful values will be generated
# after the build has completed. This file is relative to your project root.
build_info_path: "public/build.txt"

kirby_admin_email: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          34646535663833653764663539333366363135333637393162613166306664343330303235386330
          6536356633373332313732376366346430303930343339370a396266643365346534396161323161
          66643330366535363064643336393566613437653131333630336639633335316463613561306266
          6466396536323532640a393361376566323766326639343161393838353665376431656133333366
          39383439383535326435316562316139303137363430376562356261656664326435

kirby_admin_password_hash: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          65316132393965646635396234623065373831613839343234313034386439326539323436303738
          3165613139343337613765333036313932313534363461340a376339303463343362373362633636
          34326236353965366366633137303937343138353336613236306230663361666636643664363833
          6532643231653039320a326337663139326530383263626266656330363632333737353664356261
          63613461373131346661343263393164386130653266383836376537653636316337356162326466
          34363735336534633634333431343762663562396261643363623165336134303032313133616231
          343938343532393433656239656635643034

###################
# DEPLOY EXTRA VARS
###################

# Specify any valid remote (typically a github user)
remote: yalepaprika
repo: yalepaprika.com

# Specify any ref (eg. branch, tag, SHA) to be deployed. This ref must be
# pushed to the remote git_repo before it can be deployed.
commit: master

# Git repo address.
# For private repositories: git@github.com:{{remote}}/{{project_name}}.git
# For public: https://github.com/{{remote}}/{{project_name}}
git_repo: git@github.com:{{remote}}/{{repo}}.git

github_user: "{{ lookup('env', 'GITHUB_USER') }}"

github_user_access_token: "{{ lookup('env', 'GITHUB_USER_ACCESS_TOKEN') }}"

git_author_name: "Paprika!"

git_author_email: "infrastructure@yalepaprika.com"

# Uncomment this if if you are checking out a private repo
ansible_ssh_common_args: "-o ForwardAgent=yes"

# Clone and build the specified commit SHA, regardless of prior build status.
force: false

# Use the local project Git repo instead of the remote git_repo. This option
# only works with the vagrant inventory, and not with staging or production.
local: false
